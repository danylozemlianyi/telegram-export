# Перша стадія: Збирання додатку
FROM node:slim as builder

WORKDIR /app

# Копіювання файлів package.json і package-lock.json
COPY package*.json ./

# Встановлення залежностей
RUN npm install

# Копіювання всього коду додатку
COPY . .

# Запуск команди build
RUN npm run build

# Друга стадія: Створення кінцевого образу з Nginx
FROM nginx:alpine

# Копіювання статичних файлів з папки 'build' попереднього етапу
COPY --from=builder /app/build /usr/share/nginx/html

# Вказуємо порт, який слухаємо
EXPOSE 80

# За замовчуванням Nginx запускається сам, тому CMD не потрібна
